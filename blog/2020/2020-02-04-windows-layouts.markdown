---
layout: post
title:  "зайві розкладки клавіатури у windows"
date:   2020-02-04 17:00
categories: blog
tags: 
  - щоденник
  - windows
  - негатив
  - підказка
---

чому різні продукти microsoft рано чи пізно приносить мені стільки фрустрації? проблеми виникають з будь-якими системами, зрозуміло; але microsoft'у якось вдається зробити так, щоби і виникали вони там, де, здавалося б, все має бути просто, і вирішити їх здоровий глузд і технічна ерудиція не допомагають зовсім.

в конторі (так, я знову працюю) робочий комп'ютер знову на windows 10, і я знову зіштовхнувся з [проблемою «зайвих» клавіатурних розкладок]({% post_url 2017/2017-09-09-windows %}), котрі я не додавав і, відповідно, які не повинні бути в переліку і заважати мені перемикатися між двома розкладками!

~~любий~~ microsoft, лови промені проносу.

так чи інак, я мушу це поремонтувати, крапка.

![зображення](/assets/images/2020/2020-02-04-windows-layouts.png)


**спроба 1: windows «розумний»?**

схоже, windows динамічно додає розкладки за деяких обставин -- приміром, коли певні програми (microsoft office, звісно ж) відкривають документи «незнайомими» мовами. доступ до відповідного параметра є [з powershell](https://www.reddit.com/r/Windows10/comments/8hle7x/windows_10_keeps_adding_keyboard_layouts_without/dyl7iuq/).

перевірка:

 ```> get-winculturefromlanguagelistoptout```

якщо повертає false -- значить, цю «розумну» динамічну поведінку увімкнено; звісно ж, microsoft встановлює це за замовчуванням (чергова порція променів). вимикаємо:

 ```> set-winculturefromlanguagelistoptout -optout $true```

не сумнівайтеся, зайві розкладки нікуди не поділися з переліку -- зате тепер я можу... гхм, додати вручну, і одразу видалити, залишивши лише дві необхідні. вручну, карле! знайти ті самі розкладки, які windows додав автоматично, додати і видалити! тобто windows може автоматично напхати мені зайвих розкладок -- але не може їх автоматично прибрати; і ці люди всю дорогу розказують, як все «через дупу» зроблено в linux?!

тепер поглянемо, чи це рішення «переживе» перезавантаження.


**спроба 2: менше культури, windows!**

а дзуськи! так, після перезавантаження я таки мав лише дві розкладки, як треба -- доки не зробив щось (здається, просто додав [втулок vim vixen](https://addons.mozilla.org/fr/firefox/addon/vim-vixen) до вогнелиса), після чого знову «вилізли» дві зайві: канадійська англійська й канадійська французька. і знову прибрати їх додаванням і видаленням неможливо. 

одразу ж перевірив, чи налаштування outout збережено — так: `get-winculturefromlanguagelistoptout` повертає `$true`. треба гуглити далі...

нагуглилося [таке](https://windowsreport.com/windows-automatically-adds-keyboard-layout/): потрібно ще більше обмежити автоматичне встановлення «культур» (locale) кількома командами powershell...

 ```> set-winuilanguageoverride -language fr-CA```
 ```> set-windefaultinputmethodoverride -inputtip "0c0c:00011009"```
 ```> set-culture fr-CA```

я не знаю, де брати значення language та inputtip для інших мов і розкладок — це вам не linux, де все задокументовано, є чудові wiki та форуми... добре вже, що методом наукового тику я знайшов, що треба для мого випадку (канадійська французька за основну мову/розкладку).

і знову перевірю, чи такі налаштування допоможуть після перезавантаження.


**через тиждень**

здається, рішення допомогло: більше не бачу додаткових розкладок. solved!


**питання**

наостанок ще одна порція променів, і **питання**: працівники microsoft в не-американських офісах, де люди наче повинні здогадуватися, що в світі не лише англійською мовою спілкуються -- а ви взагалі самі своєю ж системою користуєтеся? вам зручно? у вас не виникає проблем із зайвими розкладками? чи ви невтомно клацаєте мишкою (більш просунуті з-поміж вас стирають в пил win+пробіл) попри всі проблеми?
