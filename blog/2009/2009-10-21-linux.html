---
layout: post
title: лікування проблемної флешки в linux
date: '2009-10-21T22:42:00.002+03:00'
author: tivasyk
tags:
- комп'ютери
- linux
- підказки
- нетбук
modified_time: '2010-02-16T17:31:12.830+02:00'
thumbnail: http://4.bp.blogspot.com/_wFmUV6FUCKU/St9kATWV05I/AAAAAAAAGRI/uHBbYRfA5nI/s72-c/linux_sd_error_01.png
blogger_id: tag:blogger.com,1999:blog-1498862426470895405.post-5914788221890107232
blogger_orig_url: http://www.tivasyk.info/2009/10/linux.html
---

<div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_wFmUV6FUCKU/St9kATWV05I/AAAAAAAAGRI/uHBbYRfA5nI/s1600-h/linux_sd_error_01.png" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"><img src="http://4.bp.blogspot.com/_wFmUV6FUCKU/St9kATWV05I/AAAAAAAAGRI/uHBbYRfA5nI/s200/linux_sd_error_01.png" border="0" /></a></div>для того, щоби вісім гігабайт ssd в моєму acer aspire one не навівали тугу, колись придбав карту пам’яті на 8 гб і постійно тримаю її в лівому карт-рідері. саме тут зберігаються документи, електронні книжки, скріншоти, трохи <a href="http://www.tivasyk.info/search/label/%D0%BC%D1%83%D0%B7%D0%B8%D0%BA%D0%B0">улюбленої музики</a> та <a href="http://www.tivasyk.info/search/label/%D0%BA%D1%96%D0%BD%D0%BE">два чи три фільми</a>. ssd — для системи та користувацьких налаштувань.<br /><br />аж ось днями зустрівся з дивною проблемою: флешка монтується і відкривається нормально, але відкрив у програвачі <a href="http://www.tivasyk.info/2009/08/blog-post_21.html">«вбивцю боба»</a> — і не зміг після цього зберегти файл на картку. послідовність повторювалася раз у раз, так що я став підозрювати саме програвач <i>gnome mplayer</i> в якихось дивних глюках…<br /><br /><a name='more'></a>попри непевні симптоми, все-таки кільканадцять хвилин інтенсивного пошуку в тенетах направили на вірний слід: виявляється, якщо виникають проблеми зі зчитуванням файлів, система миттю перемонтовує флешку в режимі лише читання.<br /><br />перевіряю: перемонтовую флешку (достатньо витягти й знову встромити в карт-рідер) для чистоти ексерименту, знову відкриваю файл видива, щоби спровокувати помилку... і в терміналі перевіряю повідомлення ядра (достатньо останніх 30-50 рядків):<br /><blockquote><code>dmesg | tail -50</code></blockquote>справді: серія підозрілих повідомлень свідчить про помилку файлової системи на флешці (див. скріншот збільшено).<br /><blockquote><code>fat: filesystem error (dev mmcblk1p1)</code></blockquote>отакої. доведеться лікувати. відмонтовую флешку (правий клік на зображенні флешки на стільниці, або через файл-менеджер, або через аплет місць на системній панелі…), а тоді знову в терміналі:<br /><blockquote><code>sudo fsck -a /dev/mmcblk1p1</code></blockquote>назва пристрою вказана в повідомленні про помилку (вище). <i>fsck</i> в автоматичному режимі (ключик -a) виправив усі помилки, за винятком однієї: робоча і архівна копії таблиці розташування файлів (fat) відрізняються. доводиться втрутитися:<br /><blockquote><code>sudo fsck -r /dev/mmcblk1p1</code></blockquote>тепер <i>fsck</i> запитує, яку копію використовувати надалі. по суті байдуже: все-одно проблемний файл це не порятує.<br /><br />після цього знову монтую флешку. як і слід було чекати, файл «вбивця біб» тепер має розмір не 800 з гаком мегабайт, а лише 60… видаляю його — доведеться знову завантажити з nas'а. а флешка знову працює нормально.