---
layout: post
title: нетбук з linux і зовнішній монітор в режимі розширення
date: '2009-10-23T22:13:00.004+03:00'
author: tivasyk
tags:
- комп'ютери
- linux
- нетбук
modified_time: '2010-02-16T17:44:52.940+02:00'
thumbnail: http://4.bp.blogspot.com/_wFmUV6FUCKU/SuF0Omee-tI/AAAAAAAAGTM/y8ooddxGFOk/s72-c/tivasyk_2displays.png
blogger_id: tag:blogger.com,1999:blog-1498862426470895405.post-5391381525610720014
blogger_orig_url: http://www.tivasyk.info/2009/10/linux_23.html
---

<div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_wFmUV6FUCKU/SuF0Omee-tI/AAAAAAAAGTM/y8ooddxGFOk/s1600-h/tivasyk_2displays.png" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"><img border="0" src="http://4.bp.blogspot.com/_wFmUV6FUCKU/SuF0Omee-tI/AAAAAAAAGTM/y8ooddxGFOk/s200/tivasyk_2displays.png" /></a></div>хоча на відміну від більшості користувачів нетбуків, я цілком задоволений дев'ятидюймовим дисплеєм <a href="http://www.tivasyk.info/2008/08/aspire-one.html">aspire one</a>, проте вдома таки частенько переключаюся на 20 дюймів монітора: стільниці забагато не буває. тим більше, що <i>lxrandr</i> виявився <a href="http://www.tivasyk.info/2009/10/blog-post_5555.html">простою і зручною у використанні</a> програмкою.<br /><br />а все-таки завжди хочеться більшого:<br /><ul><li>навчити нетбук автоматично вимикати вбудований дисплей при підключенні зовнішнього монітора</li><li>навчитися підключати монітор в режимі розширення стільниці на основному дисплеї<br /></li></ul>першу задачку залишу на пізніше: вона цікава, але заскладна як на мій нульовий досвід скриптування в linux. а от з другою я спробував розібратися, орієнтуючись на <a href="http://www.tivasyk.info/2009/10/blog-post_5555.html?showComment=1256110492274#c354399899656296641">пару підказок</a> віталія зінченка.<br /><br /><span id="fullpost"><a name='more'></a>одразу <b>попереджу</b>, що фінального, хорошого і правильного рецепту я так і не виробив ще, тому перш ніж братися до налаштування своєї зв'язки нетбук+монітор, варто прочитати увесь допис, або хоча би підсумок.<br /></span><br /><h3><span id="fullpost"><br />режими: клонування і розширення</span></h3><div class="separator" style="clear: both; text-align: center;"><span id="fullpost"><a href="http://2.bp.blogspot.com/_wFmUV6FUCKU/SuF-BofA2jI/AAAAAAAAGTc/LmgJ4fcBkIE/s1600-h/tivasyk_2displays_02.png" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"><img border="0" src="http://2.bp.blogspot.com/_wFmUV6FUCKU/SuF-BofA2jI/AAAAAAAAGTc/LmgJ4fcBkIE/s320/tivasyk_2displays_02.png" /></a></span></div><span id="fullpost">по-перше, різниця між режимами роботи двох (і більше) дисплеїв:<br /></span><br /><ul><span id="fullpost"><li>клонування (<a href="http://en.wikipedia.org/wiki/Multi-monitor#Clone_mode">cloning або mirroring</a>): обидва дисплеї показують одну стільницю (однакове зображення)<br /></li><li>розширення (<a href="http://en.wikipedia.org/wiki/Multi-monitor#Extended_mode">extension</a>): два дисплеї «доповнюють» один одного, показуючи дві прилеглі ділянки великої віртуальної стільниці<br /></li></span></ul><span id="fullpost">насправді це лише два простих часткових випадки однієї технології, коли два дисплеї відображають довільні ділянки віртуального екрану. але не буду лізти в хащі =)<br /><br />до речі, робота з кількома дисплеями — «хвора тема» для більшости дистрибутивів linux, а от в ос windows все налаштовується дуже просто штатним аплетом системної панелі: є в чім позаздрити користувачам «вікон».<br /><br /></span><br /><h3><span id="fullpost">конфігурація</span></h3><div class="separator" style="clear: both; text-align: center;"><span id="fullpost"><a href="http://1.bp.blogspot.com/_wFmUV6FUCKU/SuGBzyWG6sI/AAAAAAAAGTk/2HyLddKjXUo/s1600-h/tivasyk_2displays_03.png" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"><img border="0" src="http://1.bp.blogspot.com/_wFmUV6FUCKU/SuGBzyWG6sI/AAAAAAAAGTk/2HyLddKjXUo/s200/tivasyk_2displays_03.png" /></a></span></div><span id="fullpost">отже в чім задача? дисплей нетбука зручно розташований під монітором (див. <a href="http://4.bp.blogspot.com/_wFmUV6FUCKU/SuF0Omee-tI/AAAAAAAAGTM/y8ooddxGFOk/s200/tivasyk_2displays.png">ілюстрацію вище</a>), так що хочеться, щоби зображення на зовнішньому моніторі «доповнювало» стільницю нетбука зверху — так, щоб вікна можна було довільно пересувати «з одного дисплею на інший».<br /><br />для системи це виглядає так: великий віртуальний екран, який за розмірами вміщує зображення для обох дисплеїв (див. <a href="http://1.bp.blogspot.com/_wFmUV6FUCKU/SuGBzyWG6sI/AAAAAAAAGTk/2HyLddKjXUo/s200/tivasyk_2displays_03.png">ілюстрацію</a>). і два дисплеї, котрі відображають різні ділянки віртуального екрану.<br /><br /></span><br /><h3><span id="fullpost">інструмент</span></h3><span id="fullpost">все, що нам треба, вміє <a href="http://en.wikipedia.org/wiki/RandR">xrandr</a> — консольна програма для динамічного налаштування характеристик відображення без перезавантаження графічного сервера x. детальну інструкцію з використання <i>xrandr</i>, написану мовою роботів та програмістів, можна завжди отримати по команді<br /></span><br /><blockquote><code><span id="fullpost"> man xrandr</span></code></blockquote><span id="fullpost">якщо коротко, то базовий <a href="http://www.tivasyk.info/2009/10/blog-post_5555.html?showComment=1256123944312#c7111327783349976964">синтаксис команди</a> виглядає так:<br /></span><br /><blockquote><code><span id="fullpost">xrandr --output (output) --mode (mode) --left-of|--right-of|--above|--below|--same-as (output)</span></code></blockquote><span id="fullpost">ключовий параметр — <i><b>output</b></i>, він визначає, до якого дисплея стосуватимуться налаштування, і <a href="http://www.tivasyk.info/2009/10/blog-post_5555.html?showComment=1256123944312#c7111327783349976964">конкретні значення</a> специфічні для різних виробників — ati, intel чи nvidia. для нетбуків aspire one та аналогічних, що використовують інтегровану в чіпсет графіку intel, важливі два ідентифікатори:<br /></span><br /><ul><span id="fullpost"><li><i>lvds</i> — дисплей нетбука</li><li><i>vga</i> — зовнішній монітор чи проектор<br /></li></span></ul><span id="fullpost">параметр <b><i>mode</i></b> визначає розмір зображення; для дисплея нетбука aspire one (l110/a150) це 1024x600 пікселів, для зовнішнього монітора в моєму випадку 1680x1050 (див. <a href="http://1.bp.blogspot.com/_wFmUV6FUCKU/SuGBzyWG6sI/AAAAAAAAGTk/2HyLddKjXUo/s200/tivasyk_2displays_03.png">ілюстрацію</a>).<br /><br />у <i>xrandr</i> ще багато інших параметрів, але наразі вони не настільки важливі, і з ними можна розбиратися пізніше.<br /><br /></span><br /><h3><span id="fullpost">віртуальний екран</span></h3><div class="separator" style="clear: both; text-align: center;"><span id="fullpost"><a href="http://4.bp.blogspot.com/_wFmUV6FUCKU/SuHWC9UxomI/AAAAAAAAGT0/484ZRFnKaB4/s1600-h/linux_xrandr_01.jpg" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"><img border="0" height="116" src="http://4.bp.blogspot.com/_wFmUV6FUCKU/SuHWC9UxomI/AAAAAAAAGT0/484ZRFnKaB4/s200/linux_xrandr_01.jpg" width="200" /></a></span></div><span id="fullpost">важлива функція <i>xrandr</i> — якщо запустити програму без параметрів (або з одним параметром <i>-q</i>), вона покаже перелік підключених дисплеїв та усі їхні підтримувані розміри зображення (див. <a href="http://4.bp.blogspot.com/_wFmUV6FUCKU/SuHWC9UxomI/AAAAAAAAGT0/484ZRFnKaB4/s200/linux_xrandr_01.jpg">ілюстрацію</a>). ця інформація знадобиться, щоби вирахувати розмір віртуального екрану.<br /><br />в моєму конкретному прикладі віртуальний екран матиме ширину 1680 пікселів і висоту 1050+600=1650 пікселів. ці параметри треба прописати в файл конфігураціі <i>/etc/X11/xorg.conf</i>, додавши буквально три рядки до секції <i>"screen"</i>:<br /></span><br /><blockquote><code><span id="fullpost">SubSection "Display"<br />&nbsp;&nbsp;Virtual 1680 1650<br />EndSubSection </span></code></blockquote><span id="fullpost">зайвий раз нагадаю: редагувати файл <i>xorg.conf</i> треба в режимі адміністратора, і <b>дуже уважно</b>, зробивши попередньо резервну копію! буквально одна помилка може призвести до того, що після перезавантаження графічний сервер не запуститься, і користувач залишиться один на один з командним рядком: не найкращий сценарій для новачка.<br /><br />фінальний вигляд секції <i>"screen"</i> може бути приблизно такий:<br /></span><br /><blockquote><code><span id="fullpost">Section "Screen"<br />&nbsp;&nbsp;Identifier "Default Screen"<br />&nbsp;&nbsp;Monitor "Configured Monitor"<br />&nbsp;&nbsp;Device "Configured Video Device"<br />&nbsp;&nbsp;DefaultDepth 24<br />&nbsp;&nbsp;<span style="color: #cc0000;">SubSection "Display"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #cc0000;">Virtual 1680 1650</span> <br />&nbsp;&nbsp;<span style="color: #cc0000;">EndSubSection</span><br />EndSection</span></code></blockquote><span id="fullpost">тепер починається справжня магія <i>xrandr</i>.<br /><br /></span><br /><h3><span id="fullpost">трошки магії</span></h3><span id="fullpost">віталій зінченко підказав <a href="http://www.tivasyk.info/2009/10/blog-post_5555.html?showComment=1256110492274#c354399899656296641">готовий варіант команди</a> для мого випадку:<br /></span><br /><blockquote><code><span id="fullpost">xrandr --output LVDS --mode 1024x600 --output VGA --mode 1680x1050 --above LVDS</span></code></blockquote><span id="fullpost">вийшло?! обидва дисплеї працюють і наче справді розташовані один над іншим, миша «гуляє» між ними і можна перетягувати вікна… майже. є декілька проблем:<br /></span><br /><ul><span id="fullpost"><li>зображення на дисплеї нетбука зсунуте вліво відносно того, як треба було за схемою;</li><li>панель xfce, іконки стільниці, індикатори conky «перескочили» на зовнішній монітор замість того, щоби залишитися на нетбуці;</li><li>вікна можна пересувати між дисплеями, але вони не хочуть повністю спускатися на дисплей нетбука: заголовок вікна завжди залишається над панеллю xfce.<br /></li></span></ul><span id="fullpost">погугливши та вчитавшись уважно в документацію xrandr, я доволі розібрався з першою проблемою: треба трошки модифікувати команду. але найперше повертаюся до роботи з одним дисплеєм, відключивши зовнішній монітор — <a href="http://www.tivasyk.info/2009/10/blog-post_5555.html">за допомогою lxrandr</a>, або такою командою:<br /></span><br /><blockquote><code><span id="fullpost"> xrandr --output VGA --off</span></code></blockquote><span id="fullpost">тепер розташовую дисплеї правильно, для цього екран <i>lvds</i> треба «зсунути» відносно віртуального екрану на (1680-1024)/2 =328 пікселів вправо і на 1050 пікселів вниз (див. <a href="http://1.bp.blogspot.com/_wFmUV6FUCKU/SuGBzyWG6sI/AAAAAAAAGTk/2HyLddKjXUo/s200/tivasyk_2displays_03.png">ілюстрацію вище</a>), за це відповідає параметр <i><b>pos</b></i>:<br /></span><br /><blockquote><code><span id="fullpost">xrandr --output LVDS --mode 1024x600 <span style="color: #cc0000;">--pos 328x1050</span> --output VGA --mode 1680x1050 <span style="color: #cc0000;">--pos 0x0</span></span></code></blockquote><span id="fullpost">гаразд, щодо геометрії зображення отримав точнісінько те, що хотів. дві інших проблеми пов’язані між собою, і виникають через глюк актуальної версії xfce. вирішуються лише частково.<br /><br /></span><br /><div class="separator" style="clear: both; text-align: center;"><span id="fullpost"><a href="http://1.bp.blogspot.com/_wFmUV6FUCKU/SuH9ALtBMZI/AAAAAAAAGT8/2nYD_h08fn0/s1600-h/linux_xrandr_02.jpg" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"><img border="0" src="http://1.bp.blogspot.com/_wFmUV6FUCKU/SuH9ALtBMZI/AAAAAAAAGT8/2nYD_h08fn0/s200/linux_xrandr_02.jpg" /></a></span></div><span id="fullpost">перетягнути панель на дисплей нетбука нескладно: відкриваю параметри панелі (правий клік миші, пункт <i>упорядкування панелі</i>), у вікні налаштувань тепер можна вибрати дисплей, на якому відображати панель. перший — зовнішній монітор, другий — дислей нетбука… чому саме такий порядок? дивимося звіт <i>xrandr</i> без параметрів (див. <a href="http://4.bp.blogspot.com/_wFmUV6FUCKU/SuHWC9UxomI/AAAAAAAAGT0/484ZRFnKaB4/s200/linux_xrandr_01.jpg">ілюстрацію вище</a>): першим вказано саме екран з ідентифікатором <i>vga</i>!<br /><br />вибираю другий — панель перескочила «в нетбук». ура? а дзуськи: налаштування наче зберігається, але наступного разу, підключивши монітор, я знову бачу панель там... це — глюк xfce, виправляється перезапуском панелі:<br /></span><br /><blockquote><code><span id="fullpost"> xfce4-panel -r<br /></span></code></blockquote><span id="fullpost">і робити це доводиться щоразу. або чекати виходу поновлення xfce. так само — перезапуском — виправляється проблема дивного розташування <i>conky</i>. думаю, це можна було б автоматизувати за великого бажання.<br /><br />а от щодо розташування іконок стільниці та  — рішення не знайшов. втім, це якраз і не критично.<br /><br /></span><br /><h3><span id="fullpost">підсумок</span></h3><span id="fullpost">коротко: до нетбука з linux можна підключити зовнішній монітор в режимі розширення, і то доволі гнучко налаштовувати конфігурацію дисплеїв та віртуального екрану.<br /><br />проте принаймні в дистрибутиві linux mint 7 xfce з цим забагато мороки: все доводиться робити ручками або самотужки автоматизувати, бракує зручної графічної утиліти. і псують життя окремі глюки xfce.<br /><br />тому особисто мені набагато зручніше просто переключатися між дисплеєм нетбука і зовнішнім монітором за допомогою <i>lxrandr</i>. в перспективі — повністю автоматизую процес переключення, але про це за іншим разом.</span>