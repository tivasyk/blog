---
layout: post
title: сенсори та linux (продовження)
date: '2018-12-22T21:13:00.000+02:00'
author: tivasyk
tags:
- комп'ютери
- linux
- bash
modified_time: '2018-12-23T15:03:41.433+02:00'
thumbnail: https://4.bp.blogspot.com/-6_104xQs4wA/XB6AH36kRnI/AAAAAAABULs/n9gbn8XeIgEAEigzqLd57x74eaPhQLwdwCLcBGAs/s72-c/Screenshot_20181222_131819.jpeg
blogger_id: tag:blogger.com,1999:blog-1498862426470895405.post-3155968190409027576
blogger_orig_url: http://www.tivasyk.info/2018/12/linux.html
---

<div class="separator" style="clear: both; text-align: center;"><a href="https://4.bp.blogspot.com/-6_104xQs4wA/XB6AH36kRnI/AAAAAAABULs/n9gbn8XeIgEAEigzqLd57x74eaPhQLwdwCLcBGAs/s1600/Screenshot_20181222_131819.jpeg" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"><img border="0" data-original-height="309" data-original-width="621" height="159" src="https://4.bp.blogspot.com/-6_104xQs4wA/XB6AH36kRnI/AAAAAAABULs/n9gbn8XeIgEAEigzqLd57x74eaPhQLwdwCLcBGAs/s320/Screenshot_20181222_131819.jpeg" width="320" /></a></div>невеликий проміжний підсумок <a href="http://www.tivasyk.info/2018/12/blog-post_22.html">експериментів з сенсорами</a> на aspire r13: linux (в моєму випадку arch під капотом manjaro) від початку має необхідні драйвери для підсистеми <a href="https://wiki.analog.com/software/linux/docs/iio/iio" target="_blank">industrial i/o</a> та дає доступ до їх відгуків через дерево підтек і текстових файлів:<br /><br /><pre>/sys/bus/iio/devices/<br />└ iio:device0/             # магнетометр<br />  └ ...<br />└ iio:device1/             # датчик нахилу?<br />  └ ...<br />└ iio:device2/             # датчик кутової швидкості?<br />  └ ...<br />└ iio:device3/             # акселерометр<br />  ├ in_accel_x_raw         # вісь x: кут нахилу в площині екрана<br />  ├ in_accel_y_raw         # вісь y: кут нахилу екрану на себе/від себе <br />  ├ in_accel_z_raw         # ?<br />  └ ...<br />└ iio:device4/             # ?<br />  └ ...<br />└ iio:device5/             # сенсор освітлення<br />  ├ in_illuminance_raw     # рівень освітленості (підозрюю, що в десятих люкса)<br />  └ ...<br /></pre><br />при цьому сам manjaro ніяк ці дані не використовує: вочевидячки, дистрибутив просто не призначений для пристроїв-трансформерів чи планшетів.<br /><br />тож я накидав невеликий (і дуже чорновий) скрипт оболонки, котрий інтерпретує дані від акселерометра і сенсора освітлення (можливо, поки що не дуже коректно) і дозволяє погратися з ними — себто, покрутити ноутбуком на всі боки й спостерігати, як міняються показники:<br /><br /><iframe src="https://pastebin.com/embed_iframe/bJQsk6zN" style="border: none; height: 300px; width: 100%;"></iframe><br /><br />що далі? зібрати докупи три різних скрипти, що вже маю:<br /><ul><li>універсальний повертач екрану/тактильного екрану</li><li>перемикач режиму (пейзаж/портрет)</li><li>скрипт інтерпретування сенсорів…</li></ul>…у один автоматичний перемикач режиму ноутбук/планшет залежно від нахилу. отже, як каже <a href="https://piktor.org.ua/" target="_blank">один добрий сусіда</a> наприкінці кожного допису — не перемикайтеся =)<br /><br /><b>поновлення</b> (2018-12-22): халепа! під час завантаження сенсори монтуються до тек device0...device5 суб'єктивно випадковим чином… себто&nbsp; після перезавантаження акселерометр опинився в теці device5 замість device3… себто треба шукати спосіб <a href="http://www.tivasyk.info/2018/12/linux_23.html">динамічно визначати</a>, куди який сенсор змонтовано.