---
layout: post
title:  "pacman: помилка завантаження core.db"
date:   2019-09-18 15:30
categories: blog
tags: 
  - комп'ютери
  - linux
  - підказка
---

знадобилося підняти стару віртуальну машину з manjaro та gns3, щоби спробувати більше погратися з ansible та cisco, але спроба затягти той ansible з репозиторіїв уперлася в помилку завантаження списку пакунків… пробую траблшутити:

* інтернет наче є (google та wikipedia відкриваються в браузері)…
* …але дзеркало *osmirror.org* не відповідає;
* curl відкриває google, але не відкриває wikipedia;
* nslookup чи dig не встановлено;
* ping не «пробиває» нічого.

чи є в адмініструванні щось гірше, ніж коли декілька проблем — і не обов’язково проблем, а часом просто локальних обмежень, — накладають на купу так, що біс його й розбереш одразу… виявилося:

* ping назовні закритий корпоративними політиками (що для технологічного стартапа, гхм, дивно);
* curl в останніх версіях позбавили всіх сертифікатів безпеки, і для відкривання https потрібно «прикручувати» зовнішні (google віддає якусь «заглушку» по http, потім переадресовує, а wikipedia просто переадресовує);
* якраз канадійський *osmirror.org* — «поталанило» — недоступний, інші дзеркала працюють (зовсім не пригадую, чому я обмежив вибір дзеркал лише канадою).

в підсумку помогло перестворення списку з включенням усіх дзеркал і поновлення:

```
sudo pacman-mirrors -f 0 && sudo pacman -Syyu
```

#### бонус

manjaro «з коробки» не має nslookup чи dig… повбивав би. є таке: `getent hosts <url>` та `getent ahosts <url>`, але вони дають різні результати: 

* `getent hosts <url>` резолвить ipv6, а вже якщо прив’язки ipv6 нема — тоді покаже ipv4;
* `getent ahosts <url>` резолвить одразу ipv4 та ipv6…

звісно ж, `ifconfig` також немає, але я вже встиг звикнути до `ip address`.

![проблема й вирішення](/assets/images/2019/2019-09-18-pacman-error.jpg)